<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>洛阳机务段机车驾驶证管理系统</title>
    <link rel="stylesheet" href="../css/index.css">
</head>
<body>
<script>
    function setCardPreview()
    {
        var cardInput=document.getElementById("cardInput");
        var cardPreview=document.getElementById("cardPreview");
        if(cardInput.files &&    cardInput.files[0])
        {
            //火狐下，直接设img属性
            cardPreview.style.display = 'block';
            cardPreview.style.width = '150px';
            cardPreview.style.height = '150px';
            //imgObjPreview.src = docObj.files[0].getAsDataURL();
            //火狐7以上版本不能用上面的getAsDataURL()方式获取，需要一下方式
            cardPreview.src = window.URL.createObjectURL(cardInput.files[0]);
        }
        else
        {
            //IE下，使用滤镜
            cardInput.select();
            var imgSrc = document.selection.createRange().text;
            var cardPic = document.getElementById("cardPic");
            //图片异常的捕捉，防止用户修改后缀来伪造图片
            try
            {
                cardPic.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
                cardPic.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = imgSrc;
            }
            catch(e)
            {
                alert("您上传的图片格式不正确，请重新选择!");
                return false;
            }
            cardPreview.style.display = 'none';
            document.selection.empty();
        }
        return true;
    }
    function setPhotoPreview()
    {
        var photoInput=document.getElementById("photoInput");
        var photoPreview=document.getElementById("photoPreview");
        if(photoInput.files &&    photoInput.files[0])
        {
            //火狐下，直接设img属性
            photoPreview.style.display = 'block';
            photoPreview.style.width = '150px';
            photoPreview.style.height = '150px';
            //imgObjPreview.src = docObj.files[0].getAsDataURL();
            //火狐7以上版本不能用上面的getAsDataURL()方式获取，需要一下方式
            photoPreview.src = window.URL.createObjectURL(photoInput.files[0]);
        }
        else
        {
            //IE下，使用滤镜
            photoInput.select();
            var imgSrc = document.selection.createRange().text;
            var cardPic = document.getElementById("cardPic");
            //图片异常的捕捉，防止用户修改后缀来伪造图片
            try
            {
                cardPic.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";
                cardPic.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src = imgSrc;
            }
            catch(e)
            {
                alert("您上传的图片格式不正确，请重新选择!");
                return false;
            }
            photoPreview.style.display = 'none';
            document.selection.empty();
        }
        return true;
    }


</script>
<div id="loadingPic">
    <p>正在连接,请稍候...</p>
</div>
<div id="reasonContainer">
    <div id="reasonContent">
        <p>请选择驳回该申请的原因：</p>
        <div>
            <div>
                <input type="radio" id="short" name="reason" checked><label for="short">材料不齐全</label>
            </div>
            <div>
                <input type="radio" id="false" name="reason"/><label for="false">信息有误</label>
            </div>
        </div>
        <div class="rejectReasonDiv">
            <div><input type="checkbox" id="shortTable"/><label for="shortTable">缺少申请表</label></div>
            <div><input type="checkbox" id="shortProve"/><label for="shortProve">缺少驾驶证丢失证明</label></div>
            <div><input type="checkbox" id="shortPhy"/><label for="shortPhy">缺少体检报告</label></div>
        </div>
        <div>
            <button id="rejectReasonSubmit">确定</button>
            <button id="cancelReject">取消</button>
        </div>
    </div>
</div>
<div id="bigContent">
    <div id="leftContent">
        <p class="welcome">欢迎</p>
        <p class="name"></p>
        <ul id="buttonList">
        </ul>
    </div>
    <div id="rightContent">
        <h1 id="title">洛阳机务段机车驾驶证管理系统</h1>
        <div class="operateContent">
            <div id="appendContainer">
                <div id="checkBoxBand">
                    <input type="button" value="单个添加">
                    <input type="button" value="批次添加">
                </div>
            </div>
            <div id="queryCardContainer">
                <div id="queryCardBanner">
                    <button id="queryCardButton">查询</button><button id="htmlToXls">生成Excel文件</button>
                </div>
                <div id="moreButtonBanner">
                    <button id="more" class="more">更多...</button>
                </div>
                <div id="querySelectBanner">
                    <div id="whatToDisplay">
                        <div id="controlArea">
                            <span>查看：</span>
                            <span><input type="radio" name="select" id="all"><label for="all">全选</label></span>
                            <span><input type="radio" name="select" id="allNo"><label for="allNo">全不选</label></span>
                        </div>
                        <div id="inputArea">

                        </div>
                    </div>
                    <div id="whatToSelect" class="marginTop20px">
                        <div>选取：</div>
                        <div id="selectArea">
                            <select name="column" id="column" class="marginTop20px">
                                <option value="payId">工资号</option>
                                <option value="archivesId">档案号</option>
                                <option value="age">年龄</option>
                                <option value="fsjDate">副司机初次领证日期</option>
                                <option value="fsjRemark">副司机批准文号</option>
                                <option value="fsjDriveCode">副司机准驾类型代码</option>
                                <option value="fsjDriveType">副司机准驾类型</option>
                                <option value="sjDate">司机初次领证日期</option>
                                <option value="sjRemark">司机批准文号</option>
                                <option value="sjDriveCode">司机准驾类型代码</option>
                                <option value="sjDriveType">司机准驾类型</option>
                                <option value="startDate">有效起始日期</option>
                                <option value="deadline">有效截止日期</option>
                                <option value="remainingDays">剩余天数</option>
                                <option value="status">证件状态</option>
                            </select>
                            <div id="selectTypeDiv" class="marginTop20px"></div>
                            <div id="valueDiv"></div>

                        </div>
                    </div>


                </div>
                <div id="queryCardContent">
                </div>
                <div id="cardPageContent">
                    <span class="home">首页</span>
                    <span class="prev">上一页</span>
                    <span>第</span>
                    <span class="cur"></span>
                    <span>页&nbsp;/</span>
                    <span>共</span>
                    <span class="total"></span>
                    <span>页</span>
                    <span class="next">下一页</span>
                    <span class="last">末页</span>
                    <span>转到：第</span>
                    <select name="selectPage" class="selectPage"></select>
                    <span>页</span>
                </div>
            </div>
            <div id="dataContainer">
                数据统计
            </div>
            <div id="checkContainer">

                <div id="checkBanner">
                    <div class="float" id="exchangeApplyCheck">换证申请</div>
                    <div class="float" id="fixApplyCheck">补证申请</div>
                </div>
                <div id="checkContent">
                    <div id="exchangeApplyContent">
                        <div id="exchangeCheckContainer">
                            <table cellspacing="0" cellpadding="0" id="exchangeCheckTable">

                            </table>
                        </div>
                        <div id="exchangeApplyPage">
                            <span class="prev">上一页</span>
                            <span>第</span>
                            <span class="cur"></span>
                            <span>页&nbsp;/</span>
                            <span>共</span>
                            <span class="total"></span>
                            <span>页</span>
                            <span class="next">下一页</span>
                        </div>
                    </div>
                    <div id="fixApplyContent">
                        <div id="fixCheckContainer">
                            <table cellspacing="0" cellpadding="0" id="fixCheckTable">

                            </table>
                        </div>
                        <div id="fixApplyPage">
                            <span class="prev">上一页</span>
                            <span>第</span>
                            <span class="cur"></span>
                            <span>页&nbsp;/</span>
                            <span>共</span>
                            <span class="total"></span>
                            <span>页</span>
                            <span class="next">下一页</span>
                        </div>
                    </div>
                    <div id="informationContent">这里是详细信息</div>
                </div>
            </div>
            <div id="alertContainer">
                预警信息
            </div>
            <div id="giveOutContainer">
                证件发放
            </div>
            <div id="cancelContainer">
                证件注销
            </div>
            <div id="informationContainer">
                <div id="cardPicContent">

                </div>
                <div id="cardInfoContent">
                    <p>姓名</p><div class="name">xxx</div>
                    <p>出生日期</p><div class="birth">xxxxxxxxxx</div>
                    <p>身份证号</p><div class="idCard">xxxxxxxxxxxxxxxxxx</div><p>准驾机型</p><div class="driveType">xx</div>
                    <p>有效起始</p><div class="startDate">xxxxxxxxxx</div><p>有效截止</p><div class="deadline">xxxxxxxxxx</div>
                    <p>初次领证日期</p><div class="sjDate">xxxxxxxxxx</div><p>年鉴时间</p><div class="?">xxxxxxxxxx</div>
                </div>
            </div>
            <div id="applyContainer">
                <button id="fixButton">驾驶证不慎遗失，申请补证</button>
                <div id="fixTable">
                    <h1>铁路机车车辆驾驶证换（补）证申请表 </h1>
                    <div id="fixTableArea" class="borderAll">
                        <div class="borderAll">
                            <div class="float width572">
                                <div class="float width68 height35 borderBottom borderRight textCenter">姓名</div>
                                <div id="nameInTable" class="float width503 height35 borderBottom textCenter"></div>
                                <div class="float width68 height35 borderRight textCenter">性别</div>
                                <div id="sexInTable" class="float width125 height35 textCenter borderRight" style="width: 128px"></div>
                                <div class="width125 height35 borderRight float textCenter" style="width: 124px">出生日期</div>
                                <div class="width249 height35 float textCenter">
                                    <span id="birthYearInTable" class="height35"></span>年
                                    <span id="birthMonthInTable" class="height35"></span>月
                                    <span id="birthDateInTable" class="height35"></span>日
                                </div>
                                <div class="width572 float borderTop">
                                    <div class="width122 height35 float">公民身份号码</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                    <div class="cardIdInTable borderLeft width24 height35 float">1</div>
                                </div>
                                <div class="width572 borderTop float">
                                    <div class="width122 float height35">固定电话</div>
                                    <div class="width174 borderLeft float height35">
                                        <div class="width174 height35 noborder" id="fixedPhoneInTable"></div>
                                    </div>
                                    <div class="width99 borderLeft float height35 textCenter">移动电话</div>
                                    <div class="width174 borderLeft float height35">
                                        <div class="width174 height35 noborder" id="mobilePhoneInTable"></div>
                                    </div>
                                </div>
                                <div class="width572 float borderTop">
                                    <div class="width122 float height35 borderRight">所在企业</div>
                                    <div id="companyInTable" class="height35 width449 float textCenter">郑州局集团</div>
                                </div>
                            </div>
                            <div class="floatR width125 borderLeft borderBottom" style="height: 179px;width: 125px;">
                                <br><br>照片位置（供信息管理系统用，个人不贴）
                            </div>
                            <div class="float height35 width122 borderTop">通讯地址</div>
                            <div class="float height35 width449 borderLeft borderTop">
                                <input id="addressInTable" type="text" class="height35 width449 noborder"/>
                            </div>
                            <div class="float height35 width68 borderLeft textCenter">邮编</div>
                            <div class="float height35 borderLeft" style="width: 56px">
                                <input id="mailInTable" type="text" class="height35 width56 noborder"/>
                            </div>
                            <div class="float width122 height35 borderTop">申办类别</div>
                            <div class="float height35 width575 borderTop borderLeft">
                                <input type="checkbox" id="changeCheckBox" class="float" style="margin:8px 0 0 15px"/>
                                <label for="changeCheckBox" class="float height35" style="font-size: 14px;font-family: '仿宋';">换证</label>
                                <input type="checkbox" id="fixCheckBox" class="float" style="margin: 8px 0 0 50px"/>
                                <label for="fixCheckBox" class="float height35" style="font-size: 14px;font-family: '仿宋';">补证</label>
                            </div>
                            <div class="float height54 width122 borderTop">原证准驾<br>类型</div>
                            <div class="float width449 borderTop borderLeft height54 origin">
                                <input type="checkbox" id="originJ1" class="float"/>
                                <label for="originJ1" class="float">J1</label>
                                <input type="checkbox" id="originJ2" class="float"/>
                                <label for="originJ2" class="float">J2</label>
                                <input type="checkbox" id="originJ3" class="float"/>
                                <label for="originJ3" class="float">J3</label>
                                <input type="checkbox" id="originJ4" class="float"/>
                                <label for="originJ4" class="float">J4</label>
                                <input type="checkbox" id="originJ5" class="float"/>
                                <label for="originJ5" class="float">J5</label>
                                <input type="checkbox" id="originJ6" class="float"/>
                                <label for="originJ6" class="float">J6</label><br>
                                <input type="checkbox" id="originL1" class="float"/>
                                <label for="originL1" class="float">L1</label>
                                <input type="checkbox" id="originL2" class="float"/>
                                <label for="originL2" class="float">L2</label>
                                <input type="checkbox" id="originL3" class="float"/>
                                <label for="originL3" class="float">L3</label>
                                <input type="checkbox" id="originOther" class="float"/>
                                <label for="originOther" class="float">其他（</label>
                                <input disabled type="text" id="originOtherInput" class="noborder float" style="background-color:white;height: 16px;line-height: 16px;width: 40px"/>
                                <span class="float" style="font-weight: bold">）</span>
                            </div>
                            <div class="float width125 borderLeft height54 borderTop">
                                原证发证日期：<br>
                                <span id="originYearInTable"></span>年
                                <span id="originMonthInTable"></span>月
                                <span id="originDateInTable"></span>日
                            </div>
                            <div class="float height54 width122 borderTop">申请换（补）<br>证准驾类型</div>
                            <div class="float width575 borderTop borderLeft height54 apply">
                                <input type="checkbox" id="applyJ1" class="float"/>
                                <label for="applyJ1" class="float">J1</label>
                                <input type="checkbox" id="applyJ2" class="float"/>
                                <label for="applyJ2" class="float">J2</label>
                                <input type="checkbox" id="applyJ3" class="float"/>
                                <label for="applyJ3" class="float">J3</label>
                                <input type="checkbox" id="applyJ4" class="float"/>
                                <label for="applyJ4" class="float">J4</label>
                                <input type="checkbox" id="applyJ5" class="float"/>
                                <label for="applyJ5" class="float">J5</label>
                                <input type="checkbox" id="applyJ6" class="float"/>
                                <label for="applyJ6" class="float">J6</label><br>
                                <input type="checkbox" id="applyL1" class="float"/>
                                <label for="applyL1" class="float">L1</label>
                                <input type="checkbox" id="applyL2" class="float"/>
                                <label for="applyL2" class="float">L2</label>
                                <input type="checkbox" id="applyL3" class="float"/>
                                <label for="applyL3" class="float">L3</label>
                            </div>
                            <div class="float width122 height70 borderTop">健康检查结<br>论（换证填<br>选）</div>
                            <div class="float width575 borderTop borderLeft height70 phyCheck">
                                <input type="checkbox" id="phyOk" class="float" style="margin: 29px 0 0 15px"/>
                                <label for="phyOk" class="float height70" style="line-height: 70px">合格</label>
                                <input type="checkbox" id="phyNotOk" class="float" style="margin: 29px 0 0 35px"/>
                                <label for="phyNotOk" class="float height70" style="line-height: 70px">不合格</label>
                            </div>
                            <div class="float width122 height170 borderTop" style="line-height: 150px">申请原因</div>
                            <div class="float width575 height170 borderTop borderLeft reason">
                                <div class="width575 height28">
                                    <input type="checkbox" id="reasonDeadline" class="float"/>
                                    <label for="reasonDeadline" class="float">驾驶证有效期满</label><br>
                                </div>
                                <div class="width575 height28">
                                    <input type="checkbox" id="reasonContChange" class="float"/>
                                    <label for="reasonContChange" class="float">驾驶证记载内容变化</label><br>
                                </div>
                                <div class="width575 height28">
                                    <input type="checkbox" id="reasonLower" class="float"/>
                                    <label for="reasonLower" class="float">本人自愿降低准驾机型</label><br>
                                </div>
                                <div class="width575 height28">
                                    <input type="checkbox" id="cardBreak" class="float"/>
                                    <label for="cardBreak" class="float">驾驶证损毁</label><br>
                                </div>
                                <div class="width575 height28">
                                    <input type="checkbox" id="cardLost" class="float"/>
                                    <label for="cardLost" class="float">驾驶证丢失</label><br>
                                </div>
                                <div class="width575 height28">
                                    <input type="checkbox" id="otherReason" class="float"/>
                                    <label for="otherReason" class="float">其他说明：</label>
                                    <input disabled type="text" class="float noborder" style="background-color: white;height: 20px;line-height: 20px;font-size: 14px;font-family: '仿宋';"/>
                                </div>

                            </div>
                            <div class="float borderTop" style="width: 100%">
                                <div class="height35" style="text-align: left;margin-bottom: 20px">
                                    本人承诺上述填报内容真实有效。若提供虚假信息，本人承担相应法律责任。
                                </div>
                                <div class="floatR height35">
                                    年&nbsp;&nbsp;&nbsp;月&nbsp;&nbsp;&nbsp;日
                                </div>
                                <div class="floatR height35" style="margin-right: 100px">
                                    申请人签名：
                                </div>
                            </div>
                            <div class="width122 float borderTop" style="height: 97px;line-height: 24px">
                                <br>所在企业<br>意&nbsp;&nbsp;&nbsp;&nbsp;见
                            </div>
                            <div class="width575 float borderTop borderLeft">
                                <div style="height: 40px;line-height: 40px;text-align: left;margin-bottom: 20px">所需证明材料齐全，并已存入个人技术档案。</div>
                                <div class="floatR">
                                    ________年_______月________日<br>
                                    （所在企业公章）
                                </div>
                                <div class="floatR" style="margin-right: 80px">
                                    主管人员签名：
                                </div>
                            </div>
                            <div class="float width122 height35 borderTop">备注</div>
                            <div class="float width575 height35 borderTop borderLeft"></div>
                        </div>
                    </div>
                    <div style="text-align: left;text-indent: 8em;font-size: 14px;font-family: '仿宋'">注：此表为A4纸格式</div>
                </div>
                <button id="applySubmit">提交</button>
                <button id="print">打印</button>
            </div>
            <div id="statusContainer" style="padding-top: 50px">
                <span id="firstName"></span><span>师傅，您的驾驶证状态为：</span>
                <span id="cardStatus" style="text-decoration: underline"></span>
                <div id="alert"></div>

                <div id="applyInfo" style="margin-top: 50px;text-align: left;text-indent: 2em;padding: 90px">
                    <span id="checkStatus"></span>
                    <span id="finishStatus"></span>
                    <span id="needed"></span>
                </div>
            </div>
            <div id="improveContainer">
                <div id="picContent" class="float">
                    驾驶证扫描件
                    <div id="cardPic">
                        <img id="cardPreview" width=-1 height=-1 style="display:none" />
                    </div>
                    个人照片电子档
                    <div id="photoPic">
                        <img id="photoPreview" width=-1 height=-1 style="display:none" />
                    </div>
                </div>
                <div class="float" id="formContent">
                    <form id="cardForm">
                        <div>

                            <label for="cardInput">驾驶证扫描件:</label>
                            <input type="file" name="file" id="cardInput" accept="image/*"  onchange="setCardPreview();">
                            <br><br>
                            <input type="button" name="submit" value="上传" multiple id="cardSubmit"/>

                        </div>
                    </form>
                    <form id="photoForm">
                        <div>

                            <label for="photoInput">个人照片电子档:</label>
                            <input type="file" name="file" id="photoInput" accept="image/*"  onchange="setPhotoPreview();">
                            <br><br>
                            <input type="button" name="submit" value="上传" id="photoSubmit"/>

                        </div>
                    </form>




                </div>

            </div>
        </div>
    </div>

</div>

<script type="text/javascript" src="../js/demo.js"></script>
<script type="text/javascript" src="../js/jquery-1.11.3.js"></script>
<script type="text/javascript" src="../js/jsonExportExcel.min.js"></script>
<script type="text/javascript" src="../js/base_64.js"></script>
<script type="text/javascript" src="../js/newFunc.js"></script>
<script type="text/javascript" src="../js/index1.js"></script>
</body>
</html>